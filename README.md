# 家庭负荷预测与可解释性分析系统

## 📋 项目概述

一个完整的家庭负荷预测系统，**内置全面的可解释性分析功能**，不仅能准确预测负荷，还能自动解释预测结果背后的原因和影响因素。

## ✨ 核心特性

### 🔮 负荷预测
- **深度学习模型** - 基于LSTM的高精度家庭负荷预测
- **多模型支持** - CNN、LSTM、GRU多种模型可选
- **环境特征集成** - 融合温度、湿度、云量等环境因素

### 🔍 可解释性分析（已完全实现！）
- **智能阶段划分** - 使用HMM自动识别负荷变化的不同阶段
- **负荷水平分类** - 自动分类为低/中低/中高/高负荷
- **影响因素识别** - 识别温度、湿度、时间段等关键影响因素
- **趋势变化解释** - 分析阶段间负荷变化的原因
- **特征重要性分析** - 量化评估各因素的影响程度
- **自动报告生成** - 生成详细的文本报告和可视化图表
- **多格式输出** - 支持TXT、PNG、JSON多种格式

## 🚀 快速开始

### 方式1：运行完整的预测系统（推荐）

预测时会**自动生成可解释性分析**：

```bash
python train_household_forecast.py
# 选择 "预测模式"
# 选择要预测的日期
# 系统会自动生成：
#   - 预测结果图（含阶段划分）
#   - 可解释性分析报告（TXT）
#   - 可解释性可视化图（PNG）
#   - 结构化分析数据（JSON）
```

### 方式2：运行可解释性功能演示

快速了解可解释性功能：

```bash
# 运行演示（使用模拟数据）
python example_interpretability.py
# 或
python load_interpretability_demo.py
```

## 📖 使用文档

- **[📘 可解释性功能使用指南](README_INTERPRETABILITY.md)** - 详细的使用说明和示例
- [可解释性模型技术文档](INTERPRETABILITY_MODEL.md) - 技术细节和API文档
- [实现总结](IMPLEMENTATION_SUMMARY.md) - 实现概要
- [快速参考](QUICK_REFERENCE.md) - API快速参考

## 📊 输出示例

### 自动生成的文件

运行预测后，系统会自动在输出目录生成以下文件：

```
predictions/
├── prediction_with_stages_20240115.png    # 预测结果与阶段划分图
├── explanation_report_20240115.txt        # 详细分析报告
├── explanation_viz_20240115.png           # 可视化分析图表  
└── explanation_20240115.json              # 结构化分析数据
```

### 报告内容示例

```
【阶段详细分析】
阶段 1: 0.0h - 6.0h (低负荷)
  平均负荷: 0.45 kW
  关键影响因素:
    • 夜间时段 - 睡眠、待机负荷
    • 低温(8.5°C)可能增加供暖负荷

阶段 2: 6.0h - 9.0h (高负荷)  
  平均负荷: 2.35 kW
  关键影响因素:
    • 早高峰时段 - 起床、早餐活动
    • 温度适中，家庭活动增加

【趋势变化分析】
阶段1→阶段2: 显著上升 (+422%)
  原因: 进入早晨时段，家庭活动显著增加
```

## 🛠️ 技术特点

### 已实现的可解释性技术
- ✅ **HMM负荷阶段划分** - 隐马尔可夫模型智能分段
- ✅ **相关性分析** - 计算环境特征与负荷的相关系数
- ✅ **自然语言生成** - 基于规则生成易懂的解释文本
- ✅ **多维度可视化** - 6种图表全面展示分析结果
- ✅ **时间模式识别** - 识别早高峰、白天、晚高峰、夜间等模式

## 💡 使用场景

- ✅ **负荷预测解释** - 理解预测结果的合理性
- ✅ **用电行为分析** - 识别用户用电模式
- ✅ **能源管理决策** - 制定需求响应策略
- ✅ **异常检测** - 识别异常用电行为

## 📦 依赖安装

```bash
pip install numpy pandas matplotlib scikit-learn scipy
# 如需训练模型，还需安装：
pip install tensorflow
```

## 🔧 系统要求

- Python 3.8+
- NumPy
- Pandas
- Matplotlib
- Scikit-learn
- SciPy
- TensorFlow/Keras（仅训练时需要）

## 🎯 核心功能说明

### 可解释性功能已完全集成！

本系统的可解释性功能**已经完全实现并集成**到预测流程中，无需额外配置。运行预测时会自动：

1. 🔄 对预测负荷进行智能阶段划分
2. 📊 分析每个阶段的负荷水平和特征
3. 🔍 识别影响负荷的关键因素（温度、湿度、时间等）
4. 📈 解释阶段间负荷变化的原因
5. 📝 生成详细的文本分析报告
6. 🎨 生成多维度可视化图表
7. 💾 导出JSON格式的结构化数据

详细使用方法请参考 [📘 可解释性功能使用指南](README_INTERPRETABILITY.md)

## 📞 问题反馈

如有问题或建议，欢迎提Issue或Pull Request！
